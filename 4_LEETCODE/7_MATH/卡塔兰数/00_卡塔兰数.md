# 卡塔兰数

## 简介
卡特兰数又称卡塔兰数，卡特兰数是组合数学中一个常出现在各种计数问题中的数列。以比利时的数学家欧仁·查理·卡塔兰 (1814–1894)的名字来命名。

其中 卡塔兰数满足一下递推关系：
$$
C_{n+1} = C_0C_n+C_1C_{n-1}+...+C_nC_0
$$


$$
(n-3)C_{n} = \frac{n}{2}(C_3C_{n-1}+C_4C_{n-2}+...+C_{n-2}C_4+C_{n-1}C_3)
$$


卡特兰数列：

 `1, 1, 2, 5, 14, 42, 132, 429, 1430, 4862, 16796, 58786, 208012, 742900, 2674440, 9694845, 35357670, 129644790, 477638700, 1767263190, 6564120420, 24466267020, 91482563640, 343059613650, 1289904147324, 4861946401452` 



## 原理

1. 设`h(n)`为**catalan**数的第`n+1`项，令`h(0)=1,h(1)=1`，**catalan**数满足递推式：
$$
h(n)= h(0)*h(n-1)+h(1)*h(n-2) + ... + h(n-1)*h(0) (n>=2)
$$
2. 另类递推式：**对于编程而言，此递推式是关键。**
   $$
   h(n)=h(n-1)*(4*n-2)/(n+1)
   $$
3. 递推关系的解为：
   $$
   h(n)=C(2n,n)/(n+1) (n=0,1,2,...)
   $$
4. 递推关系的另类解为：
   $$
   h(n)=c(2n,n)-c(2n,n-1)(n=0,1,2,...)
   $$
   



## 应用

### 不同出栈次序

问题： 一个栈(无穷大)的进栈序列为`1，2，3，…，n`，有多少个不同的出栈序列? 

分析：

1. 状态定义：$dp[i]$ 代表`1,2,...i` 有多少个不同的出栈序列.
2. 状态转移：**`假设j最后出栈`**  $dp[i] = \sum_{j=1}^{i}dp[j-1]dp[i-j]$ 卡塔兰数 即就是：$dp[i] = dp[i-1]*2*(2i-1)/(i+1)$
3. 边界：$dp[0] = 1,dp[1] = 1$

###  凸多边形三角划分

问题： 在一个凸多边形中，通过若干条互不相交的对角线，把这个多边形划分成了若干个三角形。任务是键盘上输入凸多边形的边数`n`，求不同划分的方案数`f(n)`。比如当`n=6`时，`f(6)=14`。 

分析：

1. 状态定义：$dp[i]$ 代表凸i边型有多少种三角形划分。
2. 状态转移：$dp[i] = \sum_{j=2}^{i-1}dp[j]dp[i-j+1]$ 卡塔兰数 即就是：$dp[i] = dp[i-1]*2*(2i-5)/(i-1)$
3. 边界：$dp[2] = 1,dp[3] = 1$

###  给定节点组成二叉搜索树 

问题： 给定N个节点，能构成多少种不同的二叉搜索树？

分析：

1. 状态定义：$dp[i]$ 代表`1,2,...i` 有多少种二叉搜索树。
2. 状态转移：**`假设j是顶点`** $dp[i] = \sum_{j=1}^{i}dp[j-1]dp[i-j]$ 卡塔兰数 即就是：$dp[i] = dp[i-1]*2*(2i-1)/(i+1)$
3. 边界：$dp[0] = 1,dp[1] = 1$

###  n对括号正确匹配数目

问题：给定`n`对括号，求括号正确配对的字符串数，例如：

> 0对括号：[空序列] 1种可能
>
> 1对括号：() 1种可能
>
> 2对括号：()() (()) 2种可能
>
> 3对括号：((())) ()(()) ()()() (())() (()()) 5种可能

分析：

1. 状态定义：$dp[i]$ 代表i对括号有多少种串。
2. 状态转移：**`最后一个右括号匹配的左括号为j`** $dp[i] = \sum_{j=1}^{i}dp[j-1]dp[i-j]$ 卡塔兰数 即就是：$dp[i] = dp[i-1]*2*(2i-1)/(i+1)$
3. 边界：$dp[0] = 1,dp[1] = 1$